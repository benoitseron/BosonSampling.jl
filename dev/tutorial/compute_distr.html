<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Counting statistics · BosonSampling.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../about.html"><img class="docs-light-only" src="../assets/logo.png" alt="BosonSampling.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.png" alt="BosonSampling.jl logo"/></a><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../about.html">About</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="installation.html">Installation</a></li><li><a class="tocitem" href="basic_usage.html">Basic usage</a></li><li><a class="tocitem" href="user_defined_models.html">Implementing new models</a></li><li><a class="tocitem" href="boson_samplers.html">Samplers</a></li><li><a class="tocitem" href="partitions.html">Partitions</a></li><li><a class="tocitem" href="bunching.html">Bunching</a></li><li><a class="tocitem" href="certification.html">Certification</a></li><li><a class="tocitem" href="optimization.html">Optimization</a></li><li class="is-active"><a class="tocitem" href="compute_distr.html">Counting statistics</a><ul class="internal"><li><a class="tocitem" href="#Theoretical-distribution"><span>Theoretical distribution</span></a></li><li><a class="tocitem" href="#Noisy-distribution"><span>Noisy distribution</span></a></li></ul></li><li><a class="tocitem" href="circuits.html">Circuits</a></li><li><a class="tocitem" href="permanent_conjectures.html">Permanent conjectures</a></li><li><a class="tocitem" href="python_API.html">Python API</a></li></ul></li><li><a class="tocitem" href="../benchmarks/bench.html">Benchmarks</a></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../types/input.html">Inputs</a></li><li><a class="tocitem" href="../types/events.html">Events</a></li><li><a class="tocitem" href="../types/interferometers.html">Interferometers</a></li><li><a class="tocitem" href="../types/measurements.html">Measurements</a></li><li><a class="tocitem" href="../types/partitions.html">Partitions</a></li><li><a class="tocitem" href="../types/type_functions.html">Type utilities</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../functions/bayesian.html">Certification</a></li><li><a class="tocitem" href="../functions/bunching.html">Bunching</a></li><li><a class="tocitem" href="../functions/distributions.html">Distributions</a></li><li><a class="tocitem" href="../functions/partitions.html">Partitions</a></li><li><a class="tocitem" href="../functions/permanent_conjectures.html">Permanent conjectures</a></li><li><a class="tocitem" href="../functions/proba_tools.html">Tools</a></li><li><a class="tocitem" href="../functions/samplers.html">Samplers</a></li><li><a class="tocitem" href="../functions/scattering.html">Scattering</a></li><li><a class="tocitem" href="../functions/special_matrices.html">Special_matrices</a></li><li><a class="tocitem" href="../functions/visualize.html">Visualization</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="compute_distr.html">Counting statistics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="compute_distr.html">Counting statistics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/benoitseron/BosonSampling.jl/blob/master/docs/src/tutorial/compute_distr.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-the-photon-counting-statistics"><a class="docs-heading-anchor" href="#Computing-the-photon-counting-statistics">Computing the photon counting statistics</a><a id="Computing-the-photon-counting-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-photon-counting-statistics" title="Permalink"></a></h1><p>Given <code>n</code> photons among <code>m</code> modes, one can build several configurations. All of those possible arrangements can be retrieved by using <a href="../functions/scattering.html#BosonSampling.output_mode_occupation-Tuple{Any, Any}"><code>output_mode_occupation</code></a></p><pre><code class="nohighlight hljs">julia&gt; n = 2;

julia&gt; m = 2;

julia&gt; output_mode_occupation(n,m)
4-element Vector{Any}:
[1, 1]
[1, 2]
[2, 1]
[2, 2]</code></pre><p>giving a vector of the possible mode assignment lists. We propose here some functions that generate all the associated probabilities to end up in one of such configuration from an <a href="../types/input.html#BosonSampling.Input"><code>Input</code></a> and an <a href="../types/interferometers.html#BosonSampling.Interferometer"><code>Interferometer</code></a>. In the following, each generated probability distribution is indexed as <a href="../functions/scattering.html#BosonSampling.output_mode_occupation-Tuple{Any, Any}"><code>output_mode_occupation</code></a>, that is, <code>p[i]</code> gives the probability to obtain the outcome <code>output_mode_occupation[i]</code>.</p><h2 id="Theoretical-distribution"><a class="docs-heading-anchor" href="#Theoretical-distribution">Theoretical distribution</a><a id="Theoretical-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-distribution" title="Permalink"></a></h2><p>We propose here to see the effect of partial distinguishability through the so-called Hong-Ou-Mandel effect. It is common in the literature to use the time delay <span>$\Delta \tau$</span> between the two beams as a source of partial distinguishability in this in this context. While the distinguishability parameter itself is <span>$\Delta \omega  \Delta \tau$</span> with <span>$\Delta \omega$</span> the uncertainty of the frequency distribution. In order to make the parallel with our <a href="../types/input.html#BosonSampling.OneParameterInterpolation"><code>OneParameterInterpolation</code></a> model, we substitute the linear parameter <span>$x$</span> by <span>$1-x^2$</span>. In this way, a <a href="../types/input.html#BosonSampling.Distinguishable"><code>Distinguishable</code></a> is recovered for <span>$\Delta \omega \Delta \tau \rightarrow 0$</span>. Notice that contrary to the time delay, the interpolation parameter <span>$x$</span> is bounded because of the normalisation constraint.</p><p>As in the original HOM effect, we consider here two particles initially placed on two different modes interfering through a balanced <a href="tutorial/@ref"><code>BeamSplitter</code></a>. From several partially distinguishable inputs created from the <a href="../types/input.html#BosonSampling.OneParameterInterpolation"><code>OneParameterInterpolation</code></a> model, finally, we compute the coincidence probability (that is the probability to observe <code>[1,2]</code> and <code>[2,1]</code> at the output) thanks to <a href="../functions/distributions.html#BosonSampling.theoretical_distribution-Tuple{}"><code>theoretical_distribution</code></a>.  </p><pre><code class="nohighlight hljs">julia&gt; n = 2; # photon number

julia&gt; m = 2; # mode number

julia&gt; B = BeamSplitter(1/sqrt(2));

julia&gt; p_coinc = Vector{Float64}(undef, 0);

julia&gt; x_ = Vector{Float64}(undef, 0);

julia&gt; for x = -1:0.01:1
           local input = Input{OneParameterInterpolation}(first_modes(n,m), 1-x^2)
           p_theo = theoretical_distribution(input=input, interf=B)
           push!(p_coinc, p_theo[2] + p_theo[3])
           push!(x_, x)
       end</code></pre><p>Where we have stored the coincidence probabilities in <code>p_coinc</code>. By plotting the latter we recover the dip translating the well known two-particle interference effect when considering a <a href="../types/input.html#BosonSampling.Bosonic"><code>Bosonic</code></a> input: </p><p><img src="proba_bunching.png" alt="distr"/></p><h2 id="Noisy-distribution"><a class="docs-heading-anchor" href="#Noisy-distribution">Noisy distribution</a><a id="Noisy-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Noisy-distribution" title="Permalink"></a></h2><p>As for <a href="../functions/samplers.html#BosonSampling.noisy_sampler-Tuple{}"><code>noisy_sampler</code></a>, we sometimes want to take into account imperfections in the experimental realisation of a circuit. One can use <a href="../functions/distributions.html#BosonSampling.noisy_distribution-Tuple{}"><code>noisy_distribution</code></a> to compute the probabilities to end up in each configuration given by <a href="../functions/scattering.html#BosonSampling.output_mode_occupation-Tuple{Any, Any}"><code>output_mode_occupation</code></a> from a defined input when using a lossy interferometer</p><pre><code class="nohighlight hljs">julia&gt; n = 3;

julia&gt; m = 5;

julia&gt; distinguishability_param = 0.7;

julia&gt; my_reflectivity = 0.7;

julia&gt; my_input = Input{OneParameterInterpolation}(first_modes(n,m), distinguishability_param);

julia&gt; my_interf = RandHaar(m);

julia&gt; res = noisy_distribution(input=my_input, interf=my_interf, reflectivity=my_reflectivity)
 3-element Vector{Any}:
 [0.030092342701336063, 0.009174672025065295, 0.012301444632816206, 0.008261320762511275, 0.00825343245181492, 0.009174672025065295, 0.0015318257468957183, 0.007037230327501444, 0.0034542128581951815, 0.0032779849423985887  …  0.01245307508063033, 0.00543392525722553, 0.010053183825728736, 0.013575124678493963, 0.011494371794022762, 0.009403036769288563, 0.009156238120536536, 0.015161445820062795, 0.011494371794022764, 0.04819898039534371]
 [0.023551358197813715, 0.008260895456533175, 0.012221654757509451, 0.012336452058889868, 0.011712852102797554, 0.008260895456533173, 0.0013590732227078874, 0.007212741596498194, 0.0036595492225577186, 0.003983666401759253  …  0.00382520988349487, 0.004571718465896123, 0.009290013877211057, 0.018492288077608613, 0.016830450331890665, 0.01355520468409837, 0.009082179316484165, 0.016223969372706714, 0.016830450331890665, 0.03772226919407445]
 [0.05140000000000507, 0.013849999999999604, 0.016499999999999498, 0.0007700000000000014, 0.0024400000000000055, 0.014479999999999578, 0.0023500000000000053, 0.008769999999999811, 0.0016500000000000037, 0.0005500000000000008  …  0.018739999999999406, 0.005969999999999925, 0.006519999999999903, 0.0058099999999999315, 0.0018300000000000041, 0.002200000000000005, 0.012819999999999646, 0.016089999999999514, 0.0017100000000000038, 0.08629999999999924]</code></pre><p>Notice that <code>res</code> is a three-component vector containing three probability distributions. In fact, <a href="../functions/distributions.html#BosonSampling.noisy_distribution-Tuple{}"><code>noisy_distribution</code></a> takes three additional arguments: <code>exact</code>, <code>approx</code> and <code>samp</code>. By default, those optional parameters are set to <code>true</code> meaning that we actually compute three distributions:</p><pre><code class="nohighlight hljs">julia&gt; p_exact = res[1];

julia&gt; p_approx = res[2];

julia&gt; p_samp = res[3];</code></pre><p>The first one is the noisy version of <a href="../functions/distributions.html#BosonSampling.theoretical_distribution-Tuple{}"><code>theoretical_distribution</code></a>, the second distribution is computed such that the probabilities are truncated by neglecting the highest interference terms. The last distribution is computed thanks to a Metropolis sampler that samples from the exact distribution.</p><p><img src="distr.png" alt="distr"/></p><p>One can allow the computation of the sampled distribution only, by setting <code>exact=false, approx=false</code> when calling <code>noisy_distribution</code>.    </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="optimization.html">« Optimization</a><a class="docs-footer-nextpage" href="circuits.html">Circuits »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Tuesday 6 June 2023 15:43">Tuesday 6 June 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
